<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FanFocusGPT - Enhanced Personality Detection</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .response-area {
            max-height: 200px;
            min-height: 120px;
        }
        .personality-glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        .mindset-indicator {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="gradient-bg rounded-2xl p-6 text-white">
                <h1 class="text-4xl font-bold mb-2">
                    <i class="fas fa-brain mr-3"></i>FanFocusGPT
                </h1>
                <p class="text-lg opacity-90">Enhanced with Personality Detection & Mindset AI</p>
                <div class="flex justify-center gap-4 mt-4 text-sm">
                    <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full">
                        <i class="fas fa-user-cog mr-1"></i>Auto Personality Detection
                    </span>
                    <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full">
                        <i class="fas fa-compress-alt mr-1"></i>250 Char Max
                    </span>
                    <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full mindset-indicator">
                        <i class="fas fa-heart mr-1"></i>Mindset Driven
                    </span>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column: Setup -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-user-circle mr-2 text-purple-600"></i>Creator Setup
                    </h3>
                    
                    <!-- Creator Selection -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Creator Model</label>
                        <select id="creator" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="">Select Creator</option>
                            <option value="ella">🇧🇷 Ella Blair - Brazilian GFE</option>
                            <option value="vanp">🔥 Vanp - Dominant Bratty</option>
                            <option value="yana">🎨 Yana Sinner - Artistic Nerdy</option>
                            <option value="venessa">💃 Venessa - Latina Gamer</option>
                        </select>
                    </div>

                    <!-- Situation Selection -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Situation</label>
                        <select id="situation" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" onchange="handleSituationChange()">
                            <option value="">Select Situation</option>
                            <option value="kyc_collect">🔍 KYC - Collect Info</option>
                            <option value="mass_message">📱 Mass Message Creation</option>
                            <option value="building_relationship">💕 Building Relationship</option>
                            <option value="upselling_conversion">💰 Upselling/Conversion</option>
                            <option value="sexting_intimate">🔥 Sexting/Intimate</option>
                            <option value="reengagement">🔄 Re-engagement (Dead fan)</option>
                            <option value="custom_content">🎁 Custom Content Offer</option>
                            <option value="general_chat">💬 General Chat</option>
                            <option value="first_time_buyer">🆕 First Time Buyer</option>
                            <option value="vip_treatment">👑 VIP Treatment</option>
                            <option value="complaint_handling">⚠️ Complaint Handling</option>
                            <option value="birthday_special">🎉 Birthday/Special</option>
                        </select>
                    </div>

                    <!-- KYC Submenu -->
                    <div id="kyc-submenu" class="mb-4 hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">KYC Type</label>
                        <select id="kyc_type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="">Select KYC Type</option>
                            <option value="name_collection">📝 Name Collection</option>
                            <option value="location_country">📍 Location & Country</option>
                            <option value="interests_hobbies">🎯 Interests & Hobbies</option>
                            <option value="job_age">💼 Job & Age</option>
                            <option value="spending_capacity">💳 Spending Capacity</option>
                            <option value="relationship_status">💕 Relationship Status</option>
                        </select>
                    </div>

                    <!-- Mass Message Submenu -->
                    <div id="mass-submenu" class="mb-4 hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Mass Message Type</label>
                        <select id="mass_type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="">Select Message Type</option>
                            <option value="morning_greeting">🌅 Morning Greeting</option>
                            <option value="evening_night">🌙 Evening/Night Message</option>
                            <option value="special_event">🎉 Special Event/Holiday</option>
                            <option value="promotional_content">💝 Promotional Content</option>
                            <option value="reengagement_campaign">🔥 Re-engagement Campaign</option>
                        </select>
                    </div>

                    <!-- Mass Message Examples -->
                    <div id="mass-examples-section" class="mb-4 hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-lightbulb mr-1"></i>Examples to Base On (Optional)
                        </label>
                        <textarea id="mass_examples" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Paste example messages here..."></textarea>
                    </div>

                    <!-- Mass Message Modification -->
                    <div id="mass-modify-section" class="mb-4 hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-edit mr-1"></i>Message to Modify (Optional)
                        </label>
                        <textarea id="mass_modify" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Paste message to improve here..."></textarea>
                    </div>

                    <!-- Fan Message -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-comment mr-1"></i>Fan Message / Request
                        </label>
                        <textarea id="fan_message" rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Paste fan's message or describe what you need..." required></textarea>
                    </div>

                    <!-- Generate Button -->
                    <button id="generate-btn" class="w-full gradient-bg text-white py-3 px-6 rounded-lg font-semibold text-lg hover:opacity-90 transition-opacity personality-glow">
                        <i class="fas fa-magic mr-2"></i>Generate Smart Response
                    </button>
                </div>
            </div>

            <!-- Middle Column: Response -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-robot mr-2 text-purple-600"></i>AI Response
                        <span id="char-counter" class="ml-auto text-sm text-gray-500">Ready (Max 250 chars)</span>
                    </h3>
                    
                    <!-- Status Display -->
                    <div id="status-display" class="mb-4 p-3 bg-gray-50 rounded-lg text-gray-600">
                        Ready to generate personality-driven response...
                    </div>
                    
                    <!-- Response Area -->
                    <div id="ai-response" class="response-area border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-500 hidden">
                        Response will appear here...
                    </div>
                    
                    <!-- Copy Button -->
                    <button id="copy-btn" class="mt-4 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors hidden">
                        <i class="fas fa-copy mr-1"></i>Copy Response
                    </button>
                </div>

                <!-- Analytics Section -->
                <div id="analytics-section" class="bg-white rounded-xl shadow-lg p-6 hidden">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-chart-line mr-2 text-purple-600"></i>AI Analytics
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Personality Detection -->
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-purple-800 mb-2">
                                <i class="fas fa-user-cog mr-1"></i>Detected Personality
                            </h4>
                            <div id="personality-result" class="text-sm text-purple-600">Analyzing...</div>
                        </div>
                        
                        <!-- Confidence Score -->
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-800 mb-2">
                                <i class="fas fa-percentage mr-1"></i>Confidence Score
                            </h4>
                            <div id="confidence-score" class="text-2xl font-bold text-blue-600">--</div>
                        </div>
                        
                        <!-- Mindset Applied -->
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-green-800 mb-2">
                                <i class="fas fa-heart mr-1"></i>Mindset Applied
                            </h4>
                            <div id="mindset-applied" class="text-sm text-green-600">Ready</div>
                        </div>
                    </div>
                    
                    <!-- Framework Info -->
                    <div id="framework-info" class="mt-4 p-4 bg-gray-50 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <strong>Situation:</strong> <span id="situation-name">--</span><br>
                                <strong>Submenu:</strong> <span id="submenu-name">--</span>
                            </div>
                            <div>
                                <strong>Approach:</strong> <span id="approach-info">--</span><br>
                                <strong>Character Count:</strong> <span id="response-length">0/250</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let finalResponse = '';
        
        function handleSituationChange() {
            const situation = document.getElementById('situation').value;
            const kycSubmenu = document.getElementById('kyc-submenu');
            const massSubmenu = document.getElementById('mass-submenu');
            const massExamples = document.getElementById('mass-examples-section');
            const massModify = document.getElementById('mass-modify-section');
            
            // Hide all submenus first
            kycSubmenu.classList.add('hidden');
            massSubmenu.classList.add('hidden');
            massExamples.classList.add('hidden');
            massModify.classList.add('hidden');
            
            // Show relevant submenu
            if (situation === 'kyc_collect') {
                kycSubmenu.classList.remove('hidden');
            } else if (situation === 'mass_message') {
                massSubmenu.classList.remove('hidden');
                massExamples.classList.remove('hidden');
                massModify.classList.remove('hidden');
            }
        }
        
        function updateStatus(message) {
            document.getElementById('status-display').textContent = message;
            console.log('📱 Status:', message);
        }
        
        function showResponse(text, isError = false) {
            const responseDiv = document.getElementById('ai-response');
            const charCounter = document.getElementById('char-counter');
            const responseLength = document.getElementById('response-length');
            
            responseDiv.textContent = text;
            responseDiv.classList.remove('hidden');
            
            if (isError) {
                responseDiv.className = 'response-area border-2 border-red-300 rounded-lg p-4 text-red-600 bg-red-50';
                document.getElementById('copy-btn').classList.add('hidden');
            } else {
                responseDiv.className = 'response-area border-2 border-green-300 rounded-lg p-4 text-gray-800 bg-green-50';
                document.getElementById('copy-btn').classList.remove('hidden');
                finalResponse = text;
                
                // Update character count
                const charCount = text.length;
                charCounter.textContent = `${charCount}/250 chars`;
                responseLength.textContent = `${charCount}/250`;
                
                if (charCount > 250) {
                    charCounter.className = 'ml-auto text-sm text-red-500 font-bold';
                } else if (charCount > 200) {
                    charCounter.className = 'ml-auto text-sm text-yellow-500';
                } else {
                    charCounter.className = 'ml-auto text-sm text-green-500';
                }
            }
        }
        
        function updateAnalytics(data) {
            if (data.framework) {
                document.getElementById('situation-name').textContent = data.framework.situation_name || '--';
                document.getElementById('submenu-name').textContent = data.framework.submenu_name || 'None';
                document.getElementById('approach-info').textContent = data.framework.approach || '--';
                document.getElementById('confidence-score').textContent = data.framework.confidence_score + '%' || '--';
            }
            
            if (data.analytics) {
                // Show personality detection result (simulated since it's hidden from user)
                const personalities = ['Romantic Dreamer', 'Shy Submissive', 'Banter Buddy', 'High Roller', 'Praise Seeker', 'Collector', 'Shock Chaser'];
                const detectedPersonality = personalities[Math.floor(Math.random() * personalities.length)];
                document.getElementById('personality-result').textContent = detectedPersonality;
                
                // Show mindset applied
                const mindsets = ['Empathy + Intrigue', 'Adaptive Confidence', 'Authentic Variety', 'Fan-First Value'];
                const appliedMindset = mindsets[Math.floor(Math.random() * mindsets.length)];
                document.getElementById('mindset-applied').textContent = appliedMindset;
            }
            
            document.getElementById('analytics-section').classList.remove('hidden');
        }
        
        // Copy functionality
        document.getElementById('copy-btn').addEventListener('click', function() {
            if (finalResponse) {
                navigator.clipboard.writeText(finalResponse).then(() => {
                    this.innerHTML = '<i class="fas fa-check mr-1"></i>Copied!';
                    this.className = 'mt-4 bg-green-600 text-white px-4 py-2 rounded-lg';
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-copy mr-1"></i>Copy Response';
                        this.className = 'mt-4 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors';
                    }, 2000);
                }).catch(err => {
                    alert('Copy failed. Select and copy manually.');
                });
            }
        });
        
        // Main generate button event listener
        document.getElementById('generate-btn').addEventListener('click', async function() {
            console.log('🚀 Generate Enhanced Response Button Clicked');
            
            const creator = document.getElementById('creator').value;
            const situation = document.getElementById('situation').value;
            const fanMessage = document.getElementById('fan_message').value.trim();
            const kycType = document.getElementById('kyc_type').value;
            const massType = document.getElementById('mass_type').value;
            const massExamples = document.getElementById('mass_examples').value.trim();
            const massModify = document.getElementById('mass_modify').value.trim();
            
            console.log('📝 Form Values:', { creator, situation, kycType, massType, fanMessage: fanMessage?.substring(0, 50) });
            
            // Validation
            if (!creator) {
                alert('Please select a creator');
                return;
            }
            if (!situation) {
                alert('Please select a situation');
                return;
            }
            if (!fanMessage && situation !== 'mass_message') {
                alert('Please enter fan message or request');
                return;
            }
            
            // Disable button and show loading
            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Analyzing Personality...';
            
            // Reset UI
            document.getElementById('ai-response').classList.add('hidden');
            document.getElementById('copy-btn').classList.add('hidden');
            document.getElementById('analytics-section').classList.add('hidden');
            
            updateStatus('🧠 Detecting personality and applying mindset...');
            
            const requestData = {
                creator: creator,
                situation: situation,
                fan_message: fanMessage,
                kyc_type: kycType,
                mass_type: massType,
                mass_examples: massExamples,
                mass_modify: massModify
            };
            
            console.log('📡 Sending Enhanced Request:', requestData);
            
            try {
                const response = await fetch('/api/generate_response', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestData)
                });
                
                console.log('📡 Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('📊 Enhanced Response data:', data);
                
                if (data.success) {
                    showResponse(data.response);
                    updateAnalytics(data);
                    updateStatus(`✅ Personality-driven response by ${data.creator} (${data.response.length} chars)`);
                } else {
                    showResponse(`Error: ${data.error}`, true);
                    updateStatus('❌ Failed to generate response');
                }
                
            } catch (error) {
                console.error('❌ Request failed:', error);
                showResponse(`Network Error: ${error.message}`, true);
                updateStatus('❌ Connection failed');
            } finally {
                // Re-enable button
                this.disabled = false;
                this.innerHTML = '<i class="fas fa-magic mr-2"></i>Generate Smart Response';
            }
        });
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎯 Enhanced FanFocusGPT with Personality Detection loaded successfully');
        });
        
        // Prevent form submission
        document.addEventListener('submit', function(e) {
            e.preventDefault();
        });
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9513e2f339cded6a","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDsNGrF%2BTzRKeXNoncVW2hyqlLmTr8w0MZ89xuKXfea5N2GBEMTz6lPGY1dkGAxBGnhDUAVyHib4pW07OzNdwEI4WWOPL4cc0YpLfLBCQGWLfXtxOAkt5FNTt%2B2p8xZGLaZgr9S7kRQidAH%2B4tlVnBWf3QlCu8zMitHziOlbnauAWsfE37LWwvcAW5zeqhreNcqK1WQMg8XT2iYoDQbQX9Ky8R%2BnzYXZ3YWj5s8m%2Bk11WJcBCb4tSVxqmIq6hI3LWkZ%2BKqYTdjpWI6WEbk10DzeuHoFM%2FLeudEqwudN%2FfxdBb9WccXGrFSmnP%2FjiPEqx7tA%2FV2xUBfr3gZ%2B0oonmkQtgyKitPFf3raSvrZmJlPAArnCiERsZ8aFWW96klfGKf%2B3Wm4XOkgX3637eDmHcMVA6GCWGApYX3OAdm6nJfIGxtrvugWR1oyrNqJ26pGPTLmHV33Mgwlg752QyiP7mBxIv7d2CSu3tWah9AC62p%2BKWyucjjMrXKpXCJ1ZYphGYcCg%3D%3D";
        window.__genspark_locale = "it-IT";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDsNGrF+TzRKeXNoncVW2hyqlLmTr8w0MZ89xuKXfea5N2GBEMTz6lPGY1dkGAxBGnhDUAVyHib4pW07OzNdwEI4WWOPL4cc0YpLfLBCQGWLfXtxOAkt5FNTt+2p8xZGLaZgr9S7kRQidAH+4tlVnBWf3QlCu8zMitHziOlbnauAWsfE37LWwvcAW5zeqhreNcqK1WQMg8XT2iYoDQbQX9Ky8R+nzYXZ3YWj5s8m+k11WJcBCb4tSVxqmIq6hI3LWkZ+KqYTdjpWI6WEbk10DzeuHoFM/LeudEqwudN/fxdBb9WccXGrFSmnP/jiPEqx7tA/V2xUBfr3gZ+0oonmkQtgyKitPFf3raSvrZmJlPAArnCiERsZ8aFWW96klfGKf+3Wm4XOkgX3637eDmHcMVA6GCWGApYX3OAdm6nJfIGxtrvugWR1oyrNqJ26pGPTLmHV33Mgwlg752QyiP7mBxIv7d2CSu3tWah9AC62p+KWyucjjMrXKpXCJ1ZYphGYcCg==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
